(self.webpackChunkshell=self.webpackChunkshell||[]).push([[824],{93356:(s,m)=>{m.byteLength=function F(C){var w=y(C),j=w[1];return 3*(w[0]+j)/4-j},m.toByteArray=function U(C){var w,G,M=y(C),j=M[0],B=M[1],D=new c(function O(C,w,M){return 3*(w+M)/4-M}(0,j,B)),$=0,V=B>0?j-4:j;for(G=0;G<V;G+=4)w=f[C.charCodeAt(G)]<<18|f[C.charCodeAt(G+1)]<<12|f[C.charCodeAt(G+2)]<<6|f[C.charCodeAt(G+3)],D[$++]=w>>16&255,D[$++]=w>>8&255,D[$++]=255&w;return 2===B&&(w=f[C.charCodeAt(G)]<<2|f[C.charCodeAt(G+1)]>>4,D[$++]=255&w),1===B&&(w=f[C.charCodeAt(G)]<<10|f[C.charCodeAt(G+1)]<<4|f[C.charCodeAt(G+2)]>>2,D[$++]=w>>8&255,D[$++]=255&w),D},m.fromByteArray=function z(C){for(var w,M=C.length,j=M%3,B=[],D=16383,$=0,V=M-j;$<V;$+=D)B.push(R(C,$,$+D>V?V:$+D));return 1===j?B.push(g[(w=C[M-1])>>2]+g[w<<4&63]+"=="):2===j&&B.push(g[(w=(C[M-2]<<8)+C[M-1])>>10]+g[w>>4&63]+g[w<<2&63]+"="),B.join("")};for(var g=[],f=[],c=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=0;A<64;++A)g[A]=a[A],f[a.charCodeAt(A)]=A;function y(C){var w=C.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var M=C.indexOf("=");return-1===M&&(M=w),[M,M===w?0:4-M%4]}function P(C){return g[C>>18&63]+g[C>>12&63]+g[C>>6&63]+g[63&C]}function R(C,w,M){for(var B=[],D=w;D<M;D+=3)B.push(P((C[D]<<16&16711680)+(C[D+1]<<8&65280)+(255&C[D+2])));return B.join("")}f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},53111:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,AMD=__webpack_require__.amdO,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(s){return"[object Array]"===Object.prototype.toString.call(s)}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(s){return"object"==typeof s&&s.buffer&&s.buffer.constructor===ArrayBuffer});var createOutputMethod=function(s,m){return function(g){return new Sha256(m,!0).update(g)[s]()}},createMethod=function(s){var m=createOutputMethod("hex",s);NODE_JS&&(m=nodeWrap(m,s)),m.create=function(){return new Sha256(s)},m.update=function(c){return m.create().update(c)};for(var g=0;g<OUTPUT_TYPES.length;++g){var f=OUTPUT_TYPES[g];m[f]=createOutputMethod(f,s)}return m},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(s){if("string"==typeof s)return crypto.createHash(algorithm).update(s,"utf8").digest("hex");if(null==s)throw new Error(ERROR);return s.constructor===ArrayBuffer&&(s=new Uint8Array(s)),Array.isArray(s)||ArrayBuffer.isView(s)||s.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(s)).digest("hex"):method(s)};return nodeMethod},createHmacOutputMethod=function(s,m){return function(g,f){return new HmacSha256(g,m,!0).update(f)[s]()}},createHmacMethod=function(s){var m=createHmacOutputMethod("hex",s);m.create=function(c){return new HmacSha256(c,s)},m.update=function(c,a){return m.create(c).update(a)};for(var g=0;g<OUTPUT_TYPES.length;++g){var f=OUTPUT_TYPES[g];m[f]=createHmacOutputMethod(f,s)}return m};function Sha256(s,m){m?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=s}function HmacSha256(s,m,g){var f,c=typeof s;if("string"===c){var y,a=[],A=s.length,d=0;for(f=0;f<A;++f)(y=s.charCodeAt(f))<128?a[d++]=y:y<2048?(a[d++]=192|y>>6,a[d++]=128|63&y):y<55296||y>=57344?(a[d++]=224|y>>12,a[d++]=128|y>>6&63,a[d++]=128|63&y):(y=65536+((1023&y)<<10|1023&s.charCodeAt(++f)),a[d++]=240|y>>18,a[d++]=128|y>>12&63,a[d++]=128|y>>6&63,a[d++]=128|63&y);s=a}else{if("object"!==c)throw new Error(ERROR);if(null===s)throw new Error(ERROR);if(ARRAY_BUFFER&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!(Array.isArray(s)||ARRAY_BUFFER&&ArrayBuffer.isView(s)))throw new Error(ERROR)}s.length>64&&(s=new Sha256(m,!0).update(s).array());var F=[],O=[];for(f=0;f<64;++f){var U=s[f]||0;F[f]=92^U,O[f]=54^U}Sha256.call(this,m,g),this.update(O),this.oKeyPad=F,this.inner=!0,this.sharedMemory=g}Sha256.prototype.update=function(s){if(!this.finalized){var m,g=typeof s;if("string"!==g){if("object"!==g)throw new Error(ERROR);if(null===s)throw new Error(ERROR);if(ARRAY_BUFFER&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!(Array.isArray(s)||ARRAY_BUFFER&&ArrayBuffer.isView(s)))throw new Error(ERROR);m=!0}for(var f,a,c=0,A=s.length,d=this.blocks;c<A;){if(this.hashed&&(this.hashed=!1,d[0]=this.block,d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0),m)for(a=this.start;c<A&&a<64;++c)d[a>>2]|=s[c]<<SHIFT[3&a++];else for(a=this.start;c<A&&a<64;++c)(f=s.charCodeAt(c))<128?d[a>>2]|=f<<SHIFT[3&a++]:f<2048?(d[a>>2]|=(192|f>>6)<<SHIFT[3&a++],d[a>>2]|=(128|63&f)<<SHIFT[3&a++]):f<55296||f>=57344?(d[a>>2]|=(224|f>>12)<<SHIFT[3&a++],d[a>>2]|=(128|f>>6&63)<<SHIFT[3&a++],d[a>>2]|=(128|63&f)<<SHIFT[3&a++]):(f=65536+((1023&f)<<10|1023&s.charCodeAt(++c)),d[a>>2]|=(240|f>>18)<<SHIFT[3&a++],d[a>>2]|=(128|f>>12&63)<<SHIFT[3&a++],d[a>>2]|=(128|f>>6&63)<<SHIFT[3&a++],d[a>>2]|=(128|63&f)<<SHIFT[3&a++]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=d[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var s=this.blocks,m=this.lastByteIndex;s[16]=this.block,s[m>>2]|=EXTRA[3&m],this.block=s[16],m>=56&&(this.hashed||this.hash(),s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=this.hBytes<<3|this.bytes>>>29,s[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var F,R,w,M,j,B,s=this.h0,m=this.h1,g=this.h2,f=this.h3,c=this.h4,a=this.h5,A=this.h6,d=this.h7,y=this.blocks;for(F=16;F<64;++F)y[F]=y[F-16]+(((R=y[F-15])>>>7|R<<25)^(R>>>18|R<<14)^R>>>3)+y[F-7]+(((R=y[F-2])>>>17|R<<15)^(R>>>19|R<<13)^R>>>10)<<0;for(B=m&g,F=0;F<64;F+=4)this.first?(this.is224?(w=300032,d=(R=y[0]-1413257819)-150054599<<0,f=R+24177077<<0):(w=704751109,d=(R=y[0]-210244248)-1521486534<<0,f=R+143694565<<0),this.first=!1):(d=f+(R=d+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&a^~c&A)+K[F]+y[F])<<0,f=R+(((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+((w=s&m)^s&g^B))<<0),A=g+(R=A+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&c^~d&a)+K[F+1]+y[F+1])<<0,g=R+(((f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10))+((M=f&s)^f&m^w))<<0,a=m+(R=a+((A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&d^~A&c)+K[F+2]+y[F+2])<<0,m=R+(((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+((j=g&f)^g&s^M))<<0,c=s+(R=c+((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&A^~a&d)+K[F+3]+y[F+3])<<0,s=R+(((m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10))+((B=m&g)^m&f^j))<<0;this.h0=this.h0+s<<0,this.h1=this.h1+m<<0,this.h2=this.h2+g<<0,this.h3=this.h3+f<<0,this.h4=this.h4+c<<0,this.h5=this.h5+a<<0,this.h6=this.h6+A<<0,this.h7=this.h7+d<<0},Sha256.prototype.hex=function(){this.finalize();var s=this.h0,m=this.h1,g=this.h2,f=this.h3,c=this.h4,a=this.h5,A=this.h6,d=this.h7,y=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[m>>28&15]+HEX_CHARS[m>>24&15]+HEX_CHARS[m>>20&15]+HEX_CHARS[m>>16&15]+HEX_CHARS[m>>12&15]+HEX_CHARS[m>>8&15]+HEX_CHARS[m>>4&15]+HEX_CHARS[15&m]+HEX_CHARS[g>>28&15]+HEX_CHARS[g>>24&15]+HEX_CHARS[g>>20&15]+HEX_CHARS[g>>16&15]+HEX_CHARS[g>>12&15]+HEX_CHARS[g>>8&15]+HEX_CHARS[g>>4&15]+HEX_CHARS[15&g]+HEX_CHARS[f>>28&15]+HEX_CHARS[f>>24&15]+HEX_CHARS[f>>20&15]+HEX_CHARS[f>>16&15]+HEX_CHARS[f>>12&15]+HEX_CHARS[f>>8&15]+HEX_CHARS[f>>4&15]+HEX_CHARS[15&f]+HEX_CHARS[c>>28&15]+HEX_CHARS[c>>24&15]+HEX_CHARS[c>>20&15]+HEX_CHARS[c>>16&15]+HEX_CHARS[c>>12&15]+HEX_CHARS[c>>8&15]+HEX_CHARS[c>>4&15]+HEX_CHARS[15&c]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]+HEX_CHARS[A>>28&15]+HEX_CHARS[A>>24&15]+HEX_CHARS[A>>20&15]+HEX_CHARS[A>>16&15]+HEX_CHARS[A>>12&15]+HEX_CHARS[A>>8&15]+HEX_CHARS[A>>4&15]+HEX_CHARS[15&A];return this.is224||(y+=HEX_CHARS[d>>28&15]+HEX_CHARS[d>>24&15]+HEX_CHARS[d>>20&15]+HEX_CHARS[d>>16&15]+HEX_CHARS[d>>12&15]+HEX_CHARS[d>>8&15]+HEX_CHARS[d>>4&15]+HEX_CHARS[15&d]),y},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var s=this.h0,m=this.h1,g=this.h2,f=this.h3,c=this.h4,a=this.h5,A=this.h6,d=this.h7,y=[s>>24&255,s>>16&255,s>>8&255,255&s,m>>24&255,m>>16&255,m>>8&255,255&m,g>>24&255,g>>16&255,g>>8&255,255&g,f>>24&255,f>>16&255,f>>8&255,255&f,c>>24&255,c>>16&255,c>>8&255,255&c,a>>24&255,a>>16&255,a>>8&255,255&a,A>>24&255,A>>16&255,A>>8&255,255&A];return this.is224||y.push(d>>24&255,d>>16&255,d>>8&255,255&d),y},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var s=new ArrayBuffer(this.is224?28:32),m=new DataView(s);return m.setUint32(0,this.h0),m.setUint32(4,this.h1),m.setUint32(8,this.h2),m.setUint32(12,this.h3),m.setUint32(16,this.h4),m.setUint32(20,this.h5),m.setUint32(24,this.h6),this.is224||m.setUint32(28,this.h7),s},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var s=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(s),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))})()},32824:(s,m,g)=>{g.r(m),g.d(m,{AuthActions:()=>Et,AuthConfigActions:()=>Ct,AuthConfigEffects:()=>ct,AuthConfigModels:()=>jt,AuthConfigReducer:()=>Ht,AuthConfigRepository:()=>te,AuthConfigurationService:()=>Dt,AuthEffects:()=>ut,AuthGuard:()=>lt,AuthKeycloakService:()=>we,AuthModels:()=>Ot,AuthModule:()=>Bt,AuthReducer:()=>It,AuthRepository:()=>st,AuthType:()=>Ue,AuthUserRepository:()=>at,BLMicrofrontAuthService:()=>ge,HttpAuthRequestInterceptor:()=>Xt,Providers:()=>Nt,SilentAuthGuard:()=>ht,TokenActions:()=>Rt,TokenEffects:()=>ft,TokenModels:()=>Pt,TokenReducer:()=>Lt,TokenRepository:()=>ae,initStore:()=>vt,isAuthenticated:()=>pt,isAuthenticatedToken:()=>dt,setConf:()=>gt});var f=g(44423),c=g(47715),a=g(24676),A=g(7971),d=g(18291),y=g(87776),F=g(42930),O=g(3258),U=g(48235),P=g(48074),R=g(25482),z=g(33907),C=g(89407),w=g(52631),M=g(92393),j=g(93356),B=g(53111);if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var D=!1,V=!1;function G(){V||(V=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function Se(o){if(!(this instanceof Se))return function $(){D||(D=!0,console.warn("[KEYCLOAK] Instantiation using the `Keycloak` function has been deprecated and support will be removed in future versions. Use the `new` operator to create an instance instead."))}(),new Se(o);for(var r,E,e=this,i=[],S={enable:!0,callbackList:[],interval:5},I=document.getElementsByTagName("script"),b=0;b<I.length;b++)(-1!==I[b].src.indexOf("keycloak.js")||-1!==I[b].src.indexOf("keycloak.min.js"))&&-1!==I[b].src.indexOf("version=")&&(e.iframeVersion=I[b].src.substring(I[b].src.indexOf("version=")+8).split("&")[0]);var N=!0,L=_t(console.info),Z=_t(console.warn);function mt(t,n){for(var l=function re(t){var n=null,l=window.crypto||window.msCrypto;if(l&&l.getRandomValues&&window.Uint8Array)return n=new Uint8Array(t),l.getRandomValues(n),n;n=new Array(t);for(var v=0;v<n.length;v++)n[v]=Math.floor(256*Math.random());return n}(t),v=new Array(t),u=0;u<t;u++)v[u]=n.charCodeAt(l[u]%n.length);return String.fromCharCode.apply(null,v)}function W(){if(typeof e.authServerUrl<"u")return"/"==e.authServerUrl.charAt(e.authServerUrl.length-1)?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function ne(t,n){var l=t.code,v=t.error,u=t.prompt,k=(new Date).getTime();if(t.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(t.kc_action_status),v)if("none"!=u){var h={error:v,error_description:t.error_description};e.onAuthError&&e.onAuthError(h),n&&n.setError(h)}else n&&n.setSuccess();else if("standard"!=e.flow&&(t.access_token||t.id_token)&&T(t.access_token,null,t.id_token,!0),"implicit"!=e.flow&&l){var p="code="+l+"&grant_type=authorization_code",_=e.endpoints.token(),x=new XMLHttpRequest;x.open("POST",_,!0),x.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p+="&client_id="+encodeURIComponent(e.clientId),p+="&redirect_uri="+t.redirectUri,t.pkceCodeVerifier&&(p+="&code_verifier="+t.pkceCodeVerifier),x.withCredentials=!0,x.onreadystatechange=function(){if(4==x.readyState)if(200==x.status){var H=JSON.parse(x.responseText);T(H.access_token,H.refresh_token,H.id_token,"standard"===e.flow),He()}else e.onAuthError&&e.onAuthError(),n&&n.setError()},x.send(p)}function T(H,J,Q,Y){me(H,J,Q,k=(k+(new Date).getTime())/2),N&&(e.tokenParsed&&e.tokenParsed.nonce!=t.storedNonce||e.refreshTokenParsed&&e.refreshTokenParsed.nonce!=t.storedNonce||e.idTokenParsed&&e.idTokenParsed.nonce!=t.storedNonce)?(L("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),n&&n.setError()):Y&&(e.onAuthSuccess&&e.onAuthSuccess(),n&&n.setSuccess())}}function kt(t){return 0==t.status&&t.responseText&&t.responseURL.startsWith("file:")}function me(t,n,l,v){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),n?(e.refreshToken=n,e.refreshTokenParsed=Ie(n)):(delete e.refreshToken,delete e.refreshTokenParsed),l?(e.idToken=l,e.idTokenParsed=Ie(l)):(delete e.idToken,delete e.idTokenParsed),t){if(e.token=t,e.tokenParsed=Ie(t),e.sessionId=e.tokenParsed.session_state,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,v&&(e.timeSkew=Math.floor(v/1e3)-e.tokenParsed.iat),null!=e.timeSkew&&(L("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var u=1e3*(e.tokenParsed.exp-(new Date).getTime()/1e3+e.timeSkew);L("[KEYCLOAK] Token expires in "+Math.round(u/1e3)+" s"),u<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,u)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function Ie(t){switch((t=(t=(t=t.split(".")[1]).replace(/-/g,"+")).replace(/_/g,"/")).length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Invalid token"}return t=decodeURIComponent(escape(atob(t))),JSON.parse(t)}function St(){var t="0123456789abcdef",n=mt(36,t).split("");return n[14]="4",n[19]=t.substr(3&n[19]|8,1),n[8]=n[13]=n[18]=n[23]="-",n.join("")}function oe(t){var n=function Jt(t){var n;switch(e.flow){case"standard":n=["code","state","session_state","kc_action_status"];break;case"implicit":n=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":n=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"]}n.push("error"),n.push("error_description"),n.push("error_uri");var u,k,l=t.indexOf("?"),v=t.indexOf("#");if("query"===e.responseMode&&-1!==l?(u=t.substring(0,l),""!==(k=At(t.substring(l+1,-1!==v?v:t.length),n)).paramsString&&(u+="?"+k.paramsString),-1!==v&&(u+=t.substring(v))):"fragment"===e.responseMode&&-1!==v&&(u=t.substring(0,v),""!==(k=At(t.substring(v+1),n)).paramsString&&(u+="#"+k.paramsString)),k&&k.oauthParams)if("standard"===e.flow||"hybrid"===e.flow){if((k.oauthParams.code||k.oauthParams.error)&&k.oauthParams.state)return k.oauthParams.newUrl=u,k.oauthParams}else if("implicit"===e.flow&&(k.oauthParams.access_token||k.oauthParams.error)&&k.oauthParams.state)return k.oauthParams.newUrl=u,k.oauthParams}(t);if(n){var l=E.get(n.state);return l&&(n.valid=!0,n.redirectUri=l.redirectUri,n.storedNonce=l.nonce,n.prompt=l.prompt,n.pkceCodeVerifier=l.pkceCodeVerifier),n}}function At(t,n){for(var l=t.split("&"),v={paramsString:"",oauthParams:{}},u=0;u<l.length;u++){var k=l[u].indexOf("="),h=l[u].slice(0,k);-1!==n.indexOf(h)?v.oauthParams[h]=l[u].slice(k+1):(""!==v.paramsString&&(v.paramsString+="&"),v.paramsString+=l[u])}return v}function X(){var t={setSuccess:function(n){t.resolve(n)},setError:function(n){t.reject(n)}};return t.promise=new Promise(function(n,l){t.resolve=n,t.reject=l}),t.promise.success=function(n){return G(),this.then(function(v){n(v)}),this},t.promise.error=function(n){return G(),this.catch(function(v){n(v)}),this},t}function Fe(){var t=X();if(!S.enable||S.iframe)return t.setSuccess(),t.promise;var n=document.createElement("iframe");S.iframe=n,n.onload=function(){var u=e.endpoints.authorize();S.iframeOrigin="/"===u.charAt(0)?function $t(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}():u.substring(0,u.indexOf("/",8)),t.setSuccess()};var l=e.endpoints.checkSessionIframe();return n.setAttribute("src",l),n.setAttribute("title","keycloak-session-iframe"),n.style.display="none",document.body.appendChild(n),window.addEventListener("message",function(u){if(u.origin===S.iframeOrigin&&S.iframe.contentWindow===u.source&&("unchanged"==u.data||"changed"==u.data||"error"==u.data)){"unchanged"!=u.data&&e.clearToken();for(var k=S.callbackList.splice(0,S.callbackList.length),h=k.length-1;h>=0;--h){var p=k[h];"error"==u.data?p.setError():p.setSuccess("unchanged"==u.data)}}},!1),t.promise}function He(){S.enable&&e.token&&setTimeout(function(){ke().then(function(t){t&&He()})},1e3*S.interval)}function ke(){var t=X();if(S.iframe&&S.iframeOrigin){var n=e.clientId+" "+(e.sessionId?e.sessionId:"");S.callbackList.push(t),1==S.callbackList.length&&S.iframe.contentWindow.postMessage(n,S.iframeOrigin)}else t.setSuccess();return t.promise}function Vt(){var t=X();if(S.enable||e.silentCheckSsoRedirectUri){var n=document.createElement("iframe");n.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),n.setAttribute("title","keycloak-3p-check-iframe"),n.style.display="none",document.body.appendChild(n);var l=function(v){n.contentWindow===v.source&&("supported"!==v.data&&"unsupported"!==v.data||("unsupported"===v.data&&(S.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1),Z("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(n),window.removeEventListener("message",l),t.setSuccess()))};window.addEventListener("message",l,!1)}else t.setSuccess();return function Wt(t,n,l){var v=null,u=new Promise(function(k,h){v=setTimeout(function(){h({error:l||"Promise is not settled within timeout of "+n+"ms"})},n)});return Promise.race([t,u]).finally(function(){clearTimeout(v)})}(t.promise,e.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function Me(t){if(!t||"default"==t)return{login:function(h){return window.location.assign(e.createLoginUrl(h)),X().promise},logout:function(h){return window.location.replace(e.createLogoutUrl(h)),X().promise},register:function(h){return window.location.assign(e.createRegisterUrl(h)),X().promise},accountManagement:function(){var h=e.createAccountUrl();if(!(typeof h<"u"))throw"Not supported by the OIDC server";return window.location.href=h,X().promise},redirectUri:function(h,p){return h&&h.redirectUri?h.redirectUri:e.redirectUri?e.redirectUri:location.href}};if("cordova"==t){S.enable=!1;var n=function(h,p,_){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(h,p,_):window.open(h,p,_)},u=function(h){var p=function(h){return h&&h.cordovaOptions?Object.keys(h.cordovaOptions).reduce(function(p,_){return p[_]=h.cordovaOptions[_],p},{}):{}}(h);return p.location="no",h&&"none"==h.prompt&&(p.hidden="yes"),function(h){return Object.keys(h).reduce(function(p,_){return p.push(_+"="+h[_]),p},[]).join(",")}(p)},k=e.redirectUri||"http://localhost";return{login:function(h){var p=X(),_=u(h),x=e.createLoginUrl(h),T=n(x,"_blank",_),H=!1,J=!1,Q=function(){J=!0,T.close()};return T.addEventListener("loadstart",function(Y){0==Y.url.indexOf(k)&&(ne(oe(Y.url),p),Q(),H=!0)}),T.addEventListener("loaderror",function(Y){H||(0==Y.url.indexOf(k)?(ne(oe(Y.url),p),Q(),H=!0):(p.setError(),Q()))}),T.addEventListener("exit",function(Y){J||p.setError({reason:"closed_by_user"})}),p.promise},logout:function(h){var T,p=X(),_=e.createLogoutUrl(h),x=n(_,"_blank","location=no,hidden=yes,clearcache=yes");return x.addEventListener("loadstart",function(H){0==H.url.indexOf(k)&&x.close()}),x.addEventListener("loaderror",function(H){0==H.url.indexOf(k)||(T=!0),x.close()}),x.addEventListener("exit",function(H){T?p.setError():(e.clearToken(),p.setSuccess())}),p.promise},register:function(h){var p=X(),_=e.createRegisterUrl(),x=u(h),T=n(_,"_blank",x);return T.addEventListener("loadstart",function(H){0==H.url.indexOf(k)&&(T.close(),ne(oe(H.url),p))}),p.promise},accountManagement:function(){var h=e.createAccountUrl();if(!(typeof h<"u"))throw"Not supported by the OIDC server";var p=n(h,"_blank","location=no");p.addEventListener("loadstart",function(_){0==_.url.indexOf(k)&&p.close()})},redirectUri:function(h){return k}}}if("cordova-native"==t)return S.enable=!1,{login:function(h){var p=X(),_=e.createLoginUrl(h);return universalLinks.subscribe("keycloak",function(x){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),ne(oe(x.url),p)}),window.cordova.plugins.browsertab.openUrl(_),p.promise},logout:function(h){var p=X(),_=e.createLogoutUrl(h);return universalLinks.subscribe("keycloak",function(x){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),p.setSuccess()}),window.cordova.plugins.browsertab.openUrl(_),p.promise},register:function(h){var p=X(),_=e.createRegisterUrl(h);return universalLinks.subscribe("keycloak",function(x){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),ne(oe(x.url),p)}),window.cordova.plugins.browsertab.openUrl(_),p.promise},accountManagement:function(){var h=e.createAccountUrl();if(!(typeof h<"u"))throw"Not supported by the OIDC server";window.cordova.plugins.browsertab.openUrl(h)},redirectUri:function(h){return h&&h.redirectUri?h.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+t}e.init=function(t){if(e.authenticated=!1,E=function Zt(){try{return new Le}catch{}return new Ne}(),r=t&&["default","cordova","cordova-native"].indexOf(t.adapter)>-1?Me(t.adapter):t&&"object"==typeof t.adapter?t.adapter:window.Cordova||window.cordova?Me("cordova"):Me(),t){if(typeof t.useNonce<"u"&&(N=t.useNonce),typeof t.checkLoginIframe<"u"&&(S.enable=t.checkLoginIframe),t.checkLoginIframeInterval&&(S.interval=t.checkLoginIframeInterval),"login-required"===t.onLoad&&(e.loginRequired=!0),t.responseMode){if("query"!==t.responseMode&&"fragment"!==t.responseMode)throw"Invalid value for responseMode";e.responseMode=t.responseMode}if(t.flow){switch(t.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=t.flow}if(null!=t.timeSkew&&(e.timeSkew=t.timeSkew),t.redirectUri&&(e.redirectUri=t.redirectUri),t.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=t.silentCheckSsoRedirectUri),e.silentCheckSsoFallback="boolean"!=typeof t.silentCheckSsoFallback||t.silentCheckSsoFallback,t.pkceMethod){if("S256"!==t.pkceMethod)throw"Invalid value for pkceMethod";e.pkceMethod=t.pkceMethod}e.enableLogging="boolean"==typeof t.enableLogging&&t.enableLogging,"string"==typeof t.scope&&(e.scope=t.scope),e.messageReceiveTimeout="number"==typeof t.messageReceiveTimeout&&t.messageReceiveTimeout>0?t.messageReceiveTimeout:1e4}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var l=X(),v=X();v.promise.then(function(){e.onReady&&e.onReady(e.authenticated),l.setSuccess(e.authenticated)}).catch(function(_){l.setError(_)});var u=function Yt(t){var l,n=X();function v(x){e.endpoints=x?{authorize:function(){return x.authorization_endpoint},token:function(){return x.token_endpoint},logout:function(){if(!x.end_session_endpoint)throw"Not supported by the OIDC server";return x.end_session_endpoint},checkSessionIframe:function(){if(!x.check_session_iframe)throw"Not supported by the OIDC server";return x.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!x.userinfo_endpoint)throw"Not supported by the OIDC server";return x.userinfo_endpoint}}:{authorize:function(){return W()+"/protocol/openid-connect/auth"},token:function(){return W()+"/protocol/openid-connect/token"},logout:function(){return W()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var T=W()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(T=T+"?version="+e.iframeVersion),T},thirdPartyCookiesIframe:function(){var T=W()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(T=T+"?version="+e.iframeVersion),T},register:function(){return W()+"/protocol/openid-connect/registrations"},userinfo:function(){return W()+"/protocol/openid-connect/userinfo"}}}if(o?"string"==typeof o&&(l=o):l="keycloak.json",l)(u=new XMLHttpRequest).open("GET",l,!0),u.setRequestHeader("Accept","application/json"),u.onreadystatechange=function(){if(4==u.readyState)if(200==u.status||kt(u)){var x=JSON.parse(u.responseText);e.authServerUrl=x["auth-server-url"],e.realm=x.realm,e.clientId=x.resource,v(null),n.setSuccess()}else n.setError()},u.send();else{if(!o.clientId)throw"clientId missing";e.clientId=o.clientId;var k=o.oidcProvider;if(k)if("string"==typeof k){var _,u;_="/"==k.charAt(k.length-1)?k+".well-known/openid-configuration":k+"/.well-known/openid-configuration",(u=new XMLHttpRequest).open("GET",_,!0),u.setRequestHeader("Accept","application/json"),u.onreadystatechange=function(){4==u.readyState&&(200==u.status||kt(u)?(v(JSON.parse(u.responseText)),n.setSuccess()):n.setError())},u.send()}else v(k),n.setSuccess();else{if(!o.url)for(var h=document.getElementsByTagName("script"),p=0;p<h.length;p++)if(h[p].src.match(/.*keycloak\.js/)){o.url=h[p].src.substr(0,h[p].src.indexOf("/js/keycloak.js"));break}if(!o.realm)throw"realm missing";e.authServerUrl=o.url,e.realm=o.realm,v(null),n.setSuccess()}}return n.promise}();function k(){var _=function(H){H||(T.prompt="none"),e.login(T).then(function(){v.setSuccess()}).catch(function(J){v.setError(J)})},x=function(){var H=document.createElement("iframe"),J=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});H.setAttribute("src",J),H.setAttribute("title","keycloak-silent-check-sso"),H.style.display="none",document.body.appendChild(H);var Q=function(Y){Y.origin===window.location.origin&&H.contentWindow===Y.source&&(ne(oe(Y.data),v),document.body.removeChild(H),window.removeEventListener("message",Q))};window.addEventListener("message",Q)},T={};switch(t.onLoad){case"check-sso":S.enable?Fe().then(function(){ke().then(function(H){H?v.setSuccess():e.silentCheckSsoRedirectUri?x():_(!1)}).catch(function(H){v.setError(H)})}):e.silentCheckSsoRedirectUri?x():_(!1);break;case"login-required":_(!0);break;default:throw"Invalid value for onLoad"}}function h(){var _=oe(window.location.href);if(_&&window.history.replaceState(window.history.state,null,_.newUrl),_&&_.valid)return Fe().then(function(){ne(_,v)}).catch(function(x){v.setError(x)});t?t.token&&t.refreshToken?(me(t.token,t.refreshToken,t.idToken),S.enable?Fe().then(function(){ke().then(function(x){x?(e.onAuthSuccess&&e.onAuthSuccess(),v.setSuccess(),He()):v.setSuccess()}).catch(function(x){v.setError(x)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),v.setSuccess()}).catch(function(x){e.onAuthError&&e.onAuthError(),t.onLoad?k():v.setError(x)})):t.onLoad?k():v.setSuccess():v.setSuccess()}return u.then(function(){(function p(){var _=X(),x=function(){("interactive"===document.readyState||"complete"===document.readyState)&&(document.removeEventListener("readystatechange",x),_.setSuccess())};return document.addEventListener("readystatechange",x),x(),_.promise})().then(Vt).then(h).catch(function(_){l.setError(_)})}),u.catch(function(_){l.setError(_)}),l.promise},e.login=function(t){return r.login(t)},e.createLoginUrl=function(t){var k,n=St(),l=St(),v=r.redirectUri(t),u={state:n,nonce:l,redirectUri:encodeURIComponent(v)};t&&t.prompt&&(u.prompt=t.prompt),k=t&&"register"==t.action?e.endpoints.register():e.endpoints.authorize();var h=t&&t.scope||e.scope;h?-1===h.indexOf("openid")&&(h="openid "+h):h="openid";var p=k+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(v)+"&state="+encodeURIComponent(n)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(h);if(N&&(p=p+"&nonce="+encodeURIComponent(l)),t&&t.prompt&&(p+="&prompt="+encodeURIComponent(t.prompt)),t&&t.maxAge&&(p+="&max_age="+encodeURIComponent(t.maxAge)),t&&t.loginHint&&(p+="&login_hint="+encodeURIComponent(t.loginHint)),t&&t.idpHint&&(p+="&kc_idp_hint="+encodeURIComponent(t.idpHint)),t&&t.action&&"register"!=t.action&&(p+="&kc_action="+encodeURIComponent(t.action)),t&&t.locale&&(p+="&ui_locales="+encodeURIComponent(t.locale)),t&&t.acr){var _=function Gt(t){return JSON.stringify({id_token:{acr:t}})}(t.acr);p+="&claims="+encodeURIComponent(_)}if(e.pkceMethod){var x=function Kt(t){return mt(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}(96);u.pkceCodeVerifier=x;var T=function zt(t,n){if("S256"===t){var l=new Uint8Array(B.arrayBuffer(n));return j.fromByteArray(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}throw"Invalid value for pkceMethod"}(e.pkceMethod,x);p+="&code_challenge="+T,p+="&code_challenge_method="+e.pkceMethod}return E.add(u),p},e.logout=function(t){return r.logout(t)},e.createLogoutUrl=function(t){var n=e.endpoints.logout()+"?client_id="+encodeURIComponent(e.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(r.redirectUri(t,!1));return e.idToken&&(n+="&id_token_hint="+encodeURIComponent(e.idToken)),n},e.register=function(t){return r.register(t)},e.createRegisterUrl=function(t){return t||(t={}),t.action="register",e.createLoginUrl(t)},e.createAccountUrl=function(t){var n=W(),l=void 0;return typeof n<"u"&&(l=n+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(r.redirectUri(t))),l},e.accountManagement=function(){return r.accountManagement()},e.hasRealmRole=function(t){var n=e.realmAccess;return!!n&&n.roles.indexOf(t)>=0},e.hasResourceRole=function(t,n){if(!e.resourceAccess)return!1;var l=e.resourceAccess[n||e.clientId];return!!l&&l.roles.indexOf(t)>=0},e.loadUserProfile=function(){var t=W()+"/account",n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Authorization","bearer "+e.token);var l=X();return n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(e.profile=JSON.parse(n.responseText),l.setSuccess(e.profile)):l.setError())},n.send(),l.promise},e.loadUserInfo=function(){var t=e.endpoints.userinfo(),n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Authorization","bearer "+e.token);var l=X();return n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(e.userInfo=JSON.parse(n.responseText),l.setSuccess(e.userInfo)):l.setError())},n.send(),l.promise},e.isTokenExpired=function(t){if(!e.tokenParsed||!e.refreshToken&&"implicit"!=e.flow)throw"Not authenticated";if(null==e.timeSkew)return L("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var n=e.tokenParsed.exp-Math.ceil((new Date).getTime()/1e3)+e.timeSkew;if(t){if(isNaN(t))throw"Invalid minValidity";n-=t}return n<0},e.updateToken=function(t){var n=X();if(!e.refreshToken)return n.setError(),n.promise;t=t||5;var l=function(){var u=!1;if(-1==t?(u=!0,L("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(t))&&(u=!0,L("[KEYCLOAK] Refreshing token: token expired")),u){var k="grant_type=refresh_token&refresh_token="+e.refreshToken,h=e.endpoints.token();if(i.push(n),1==i.length){var p=new XMLHttpRequest;p.open("POST",h,!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.withCredentials=!0,k+="&client_id="+encodeURIComponent(e.clientId);var _=(new Date).getTime();p.onreadystatechange=function(){if(4==p.readyState)if(200==p.status){L("[KEYCLOAK] Token refreshed"),_=(_+(new Date).getTime())/2;var x=JSON.parse(p.responseText);me(x.access_token,x.refresh_token,x.id_token,_),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var T=i.pop();null!=T;T=i.pop())T.setSuccess(!0)}else for(Z("[KEYCLOAK] Failed to refresh token"),400==p.status&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError(),T=i.pop();null!=T;T=i.pop())T.setError(!0)},p.send(k)}}else n.setSuccess(!1)};return S.enable?ke().then(function(){l()}).catch(function(u){n.setError(u)}):l(),n.promise},e.clearToken=function(){e.token&&(me(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};var Le=function(){if(!(this instanceof Le))return new Le;function n(){for(var l=(new Date).getTime(),v=0;v<localStorage.length;v++){var u=localStorage.key(v);if(u&&0==u.indexOf("kc-callback-")){var k=localStorage.getItem(u);if(k)try{var h=JSON.parse(k).expires;(!h||h<l)&&localStorage.removeItem(u)}catch{localStorage.removeItem(u)}}}}localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test"),this.get=function(l){if(l){var v="kc-callback-"+l,u=localStorage.getItem(v);return u&&(localStorage.removeItem(v),u=JSON.parse(u)),n(),u}},this.add=function(l){n();var v="kc-callback-"+l.state;l.expires=(new Date).getTime()+36e5,localStorage.setItem(v,JSON.stringify(l))}},Ne=function(){if(!(this instanceof Ne))return new Ne;var t=this;t.get=function(u){if(u){var k=l("kc-callback-"+u);if(v("kc-callback-"+u,"",n(-100)),k)return JSON.parse(k)}},t.add=function(u){v("kc-callback-"+u.state,JSON.stringify(u),n(60))},t.removeItem=function(u){v(u,"",n(-100))};var n=function(u){var k=new Date;return k.setTime(k.getTime()+60*u*1e3),k},l=function(u){for(var k=u+"=",h=document.cookie.split(";"),p=0;p<h.length;p++){for(var _=h[p];" "==_.charAt(0);)_=_.substring(1);if(0==_.indexOf(k))return _.substring(k.length,_.length)}return""},v=function(u,k,h){var p=u+"="+k+"; expires="+h.toUTCString()+"; ";document.cookie=p}};function _t(t){return function(){e.enableLogging&&t.apply(console,Array.prototype.slice.call(arguments))}}}var xt=g(89982),Ae=g(66623);const Oe="INIT_CURRENT_AUTH_USER",je="RESET_USER",Pe="INIT_CURRENT_AUTH_USER_SUCCESS",De="INIT_CURRENT_AUTH_USER_FAILED",ce=(0,c.createAction)(Oe,(0,c.props)()),ue=(0,c.createAction)(Pe,(0,c.props)()),_e=(0,c.createAction)(De,(0,c.props)()),fe=(0,c.createAction)(je);var Et=Object.freeze({__proto__:null,INIT_CURRENT_AUTH_USER:Oe,INIT_CURRENT_AUTH_USER_FAILED:De,INIT_CURRENT_AUTH_USER_SUCCESS:Pe,RESET_USER:je,initCurrentAuthUser:ce,initCurrentAuthUserFailed:_e,initCurrentAuthUserSuccess:ue,resetUser:fe});const Xe="INIT_AUTH",Be="ADD_EXCLUDE_ENTRYPOINTS",ze="SET_AUTH_CONFIG",Ge="INIT_AUTH_COMPLETE",$e="INIT_AUTH_FAILED",le=(0,c.createAction)(ze,(0,c.props)()),xe=(0,c.createAction)(Xe,(0,c.props)()),he=(0,c.createAction)(Ge,(0,c.props)()),yt=(0,c.createAction)($e,(0,c.props)()),Ee=(0,c.createAction)(Be,(0,c.props)()),de=(0,c.createAction)("LOGOUT");var Ct=Object.freeze({__proto__:null,ADD_EXCLUDE_ENTRYPOINTS:Be,INIT_AUTH_CONFIG:Xe,INIT_AUTH_CONFIG_COMPLETE:Ge,INIT_AUTH_CONFIG_FAILED:$e,LOGOUT:"LOGOUT",SET_AUTH_CONFIG:ze,addExcludeEntrypoints:Ee,initAuthConfig:xe,initAuthConfigComplete:he,initAuthConfigFailed:yt,logout:de,setAuthConfig:le});const Ye="SET_TOKEN",Je="SET_TOKEN_COMPLETE",q=(0,c.createAction)(Ye,(0,c.props)()),ye=(0,c.createAction)(Je,(0,c.props)());var Rt=Object.freeze({__proto__:null,SET_TOKEN:Ye,SET_TOKEN_COMPLETE:Je,setToken:q,setTokenComplete:ye});const Ut=(0,c.createReducer)({_authUser:void 0},(0,c.on)(ue,(o,{authUser:e})=>({_authUser:e})),(0,c.on)(fe,o=>({_authUser:null})));function We(o,e){return Ut(o,e)}const Ce=(0,c.createFeatureSelector)("_authState"),Re=(0,c.createSelector)(Ce,o=>o),Te=(0,c.createSelector)(Ce,o=>o._authUser);var It=Object.freeze({__proto__:null,authState:Re,getAuthState:Ce,getAuthUser:Te,reducer:We});const Ft=(0,c.createReducer)({config:void 0,auth:void 0,token:void 0,authenticated:!1},(0,c.on)(he,(o,{auth:e,token:r,authenticated:i})=>({...o,auth:e,token:r,authenticated:i})),(0,c.on)(le,(o,{config:e})=>({...o,config:e})),(0,c.on)(Ee,(o,{entrypoints:e})=>o.config?{...o,config:{...o.config,excludeEndpoints:[...o.config.excludeEndpoints,...e]}}:o));function Ve(o,e){return Ft(o,e)}const ee=(0,c.createFeatureSelector)("_authConfigState"),Ze=(0,c.createSelector)(ee,o=>o),Qe=(0,c.createSelector)(ee,o=>o?.config),be=(0,c.createSelector)(ee,o=>o?.auth),qe=(0,c.createSelector)(ee,o=>o?.token),et=(0,c.createSelector)(ee,o=>o?.authenticated);var Ht=Object.freeze({__proto__:null,authConfigState:Ze,getAuth:be,getAuthConfigState:ee,getConfig:Qe,getToken:qe,isAuthenticated:et,reducer:Ve});const Mt=(0,c.createReducer)({token:void 0},(0,c.on)(ye,(o,{token:e})=>({...o,token:e})));function tt(o,e){return Mt(o,e)}const pe=(0,c.createFeatureSelector)("_tokenState"),rt=(0,c.createSelector)(pe,o=>o),nt=(0,c.createSelector)(pe,o=>o.token);var Lt=Object.freeze({__proto__:null,getToken:nt,getTokenState:pe,reducer:tt,tokenState:rt});const ie="bl_token",ot="bl_previous_url",it=[],ve=[];var Nt=Object.freeze({__proto__:null,authConfigProviders:it,authServiceProviders:ve});class ge{constructor(e,r){this.authConfigRepository=e,this.store=r}getConfig(){var e=this;return(0,f.Z)(function*(){let i,r=e.authConfigRepository.getConfig();return null==r?(i=yield it[0].getConfig(),e.store.dispatch(le({config:i}))):i=r,i})()}initLogin(e){var r=this;return(0,f.Z)(function*(){let i=yield r.login(e);return r.authConfigRepository.initAuthConfigComplete({authz:{...i.authenticationInstance},loggedIn:i.authenticated},i.token,i.authenticated,!0),i.token})()}initRefreshToken(){var e=this;return(0,f.Z)(function*(){let r=yield e.refreshToken();return e.authConfigRepository.initAuthConfigComplete({authz:{...r.authenticationInstance},loggedIn:r.authenticated},r.token,r.authenticated,!0),r.token})()}getTokenUpToDate(){var e=this;return new Promise(function(){var r=(0,f.Z)(function*(i,E){if(e.getToken())if(e.isTokenExpired())if(e.isRefreshTokenExpired())i(yield e.initLogin(!0));else try{i(yield e.initRefreshToken())}catch{i(yield e.initLogin(!0))}else i(e.getToken());else i(yield e.initLogin(!0))});return function(i,E){return r.apply(this,arguments)}}())}}let te=(()=>{class o{constructor(r){this.store=r}setAuthConfig(r){this.store.dispatch(le({config:r}))}initAuthConfig(r){this.store.dispatch(xe({login:r}))}initAuthConfigComplete(r,i,E,S){this.store.dispatch(he({auth:r,token:i,authenticated:E,redirect:S}))}addExcludeEntrypoints(r){this.store.dispatch(Ee({entrypoints:r}))}logout(){this.store.dispatch(de())}getConfig(){let r;return this.getConfig$().pipe((0,d.q)(1)).subscribe(i=>r=i),r}getAuth(){let r;return this.getAuth$().pipe((0,d.q)(1)).subscribe(i=>r=i),r}getConfig$(){return this.store.select(Qe)}getAuth$(){return this.store.select(be)}getToken$(){return this.store.select(qe)}getToken(){let r;return this.getToken$().pipe((0,d.q)(1)).subscribe(i=>r=i),r}isAuthenticated(){let r;return this.isAuthenticated$().pipe((0,d.q)(1)).subscribe(i=>r=i),r}isAuthenticated$(){return this.store.select(et)}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(c.Store))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),at=(()=>{class o{constructor(r){this.store=r}initCurrentAuthUser(r,i){this.store.dispatch(ce({data:i,appKey:r}))}resetUser(){this.store.dispatch(fe())}getUser(){return new Promise((r,i)=>{this.store.select(Te).pipe((0,d.q)(1)).subscribe(E=>{r(E)})})}getUser$(){return this.store.select(Te)}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(c.Store))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),st=(()=>{class o{constructor(r){this.store=r}isAuthenticated$(){return this.store.select(pt)}isAuthenticated(){let r;return this.isAuthenticated$().pipe((0,d.q)(1)).subscribe(i=>r=i),r}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(c.Store))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),we=(()=>{class o extends ge{constructor(r,i,E){super(r,i),this.authConfigRepository=r,this.store=i,this.tokenRepository=E}extractUserInformationFromToken(r){let i=this.tokenRepository.getTokenParsed(r);return{firstname:i.given_name,lastname:i.family_name,email:i.email,imageUrl:void 0,extras:{...i}}}login(r){var i=this;return new Promise(function(){var E=(0,f.Z)(function*(S,I){let b=i.authConfigRepository.getAuth(),N=yield i.getConfig();i.initKeycloak(N,b,r??!0).subscribe(re=>{S({authenticationInstance:re.authz,token:re.authz.token,authenticated:re.authz.authenticated})},re=>{console.error(re),I("Error during the token refresh")})});return function(S,I){return E.apply(this,arguments)}}())}logout(){this.authConfigRepository.getAuth().authz.logout({redirectUri:document.baseURI})}refreshToken(){return new Promise((r,i)=>{o.keycloakAuth.updateToken(5).then(E=>{r({authenticationInstance:o.keycloakAuth,token:o.keycloakAuth.token,authenticated:o.keycloakAuth.authenticated})}).catch(E=>{console.error(E),i("Error during the token refresh")})})}getToken(){let r=this.authConfigRepository.getAuth();if(r&&r.authz.token)return r.authz.authenticated?r.authz.token:void 0}isTokenExpired(){let r=!0,i=this.authConfigRepository.getAuth();if(i&&i.authz.token){let E=i.authz;try{r=E.isTokenExpired(5)}catch{r=!0}}return r}isRefreshTokenExpired(){let r=this.authConfigRepository.getAuth();if(r&&r.authz.token){let E=r.authz;return E.refreshTokenParsed.exp-Math.ceil((new Date).getTime()/1e3)+E.timeSkew<0}return!0}initKeycloak(r,i,E){let S={...i};return o.keycloakAuth=Se({url:r.authServerUrl,realm:r.realm,clientId:r.clientId}),(0,z.D)(new Promise((b,N)=>{o.keycloakAuth.init({onLoad:"check-sso",silentCheckSsoRedirectUri:(r.silentCheckSsoRedirectUri??window.location.origin)+"/assets/silent-check-sso.html"}).then(()=>{!o.keycloakAuth.authenticated&&E&&o.keycloakAuth.login(),S.loggedIn=!1,S.authz={...o.keycloakAuth},b(S)}).catch(()=>{N()})}))}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(te),a.\u0275\u0275inject(c.Store),a.\u0275\u0275inject(ae))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),ae=(()=>{class o{constructor(r,i){this.store=r,this.injector=i}setToken(r){this.store.dispatch(q({token:r}))}getToken(){return(0,U.observableToInstantValue)(this.getToken$())}getToken$(){return this.store.select(nt)}tokenExpired(r){return Math.floor((new Date).getTime()/1e3)>=r}getAuthService(){let r=ve[0];if(null==r)try{r=this.injector.get(ge)}catch{(0,a.runInInjectionContext)(this.injector,()=>{(0,a.inject)(we)}),r=this.injector.get(ge)}return r}addTokenToHeader(r=new R.HttpHeaders){var i=this;return C.y.create(function(){var E=(0,f.Z)(function*(S){try{let I;i.bLMicrofrontAuthService=i.getAuthService(),I=yield i.bLMicrofrontAuthService.getTokenUpToDate(),I&&(r=r.set("Authorization","Bearer "+I)),S.next(r),S.complete()}catch{S.next(r)}});return function(S){return E.apply(this,arguments)}}())}getTokenParsed(r){let i;try{i=(0,M.Z)(r)}catch{i=void 0}return i}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(c.Store),a.\u0275\u0275inject(a.Injector))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),ct=(()=>{class o{constructor(r,i,E,S){var I=this;this.action$=r,this.store=i,this.tokenRepository=E,this.injector=S,this.initAuth$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(xe),(0,y.U)(function(){var b=(0,f.Z)(function*({login:N}){let L=I.getAuthService();L&&(yield L.initLogin(N))});return function(N){return b.apply(this,arguments)}}())),{dispatch:!1}),this.initAuthConfigComplete$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(he),(0,y.U)(({token:b})=>{let N;if(this.store.select(U.getShellName).pipe((0,d.q)(1)).subscribe(L=>N=L),null!=b){this.store.dispatch(q({token:b}));let L=this.getAuthService();if(L){let Z=L.extractUserInformationFromToken(b);this.store.dispatch(ce({data:Z,appKey:N}))}}else this.store.dispatch(q({token:void 0})),localStorage.removeItem(ie)})),{dispatch:!1}),this.logout$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(de),(0,y.U)(()=>{this.store.dispatch(q({token:void 0})),this.store.dispatch(fe()),P.GlobalStore.Get(!1).DispatchAction("ActionStore",(0,U.EmitAction)({actionType:"SET_AUTH_USER",payload:{authUser:{}}})),localStorage.removeItem(ie),localStorage.removeItem("ASKED_ROUTE");let L=this.getAuthService();L&&L.logout()})),{dispatch:!1})}getAuthService(){return ve[0]}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(A.Actions),a.\u0275\u0275inject(c.Store),a.\u0275\u0275inject(ae),a.\u0275\u0275inject(a.Injector))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),ut=(()=>{class o{constructor(r,i){this.action$=r,this.store=i,this.initCurrentAuthUser$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(ce),(0,F.w)(({data:E,appKey:S})=>(0,w.of)(E?ue({authUser:E,appKey:S}):_e({error:"Intance not yet loaded",logoutUser:!1}))))),this.initCurrentAuthUserSuccess$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(ue),(0,y.U)(({authUser:E,appKey:S})=>{let I;this.store.select(U.getShellName).pipe((0,d.q)(1)).subscribe(Z=>I=Z);let b=P.GlobalStore.Get(!1),N=b.GetPartnerState("GlobalStore")._authUserState,L={actionType:"SET_AUTH_USER",payload:{authUser:S==I?{...N._user,firstname:E.firstname,lastname:E.lastname,email:E.email,imageUrl:E.imageUrl,extras:E.extras}:{...N._user,extras:{...N._user.extras,[S]:{...E.extras}}}}};b.DispatchAction("ActionStore",(0,U.EmitAction)(L))})),{dispatch:!1}),this.initCurrentAuthUserFailed$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(_e),(0,y.U)(({logoutUser:E})=>{E&&this.store.dispatch(de())})),{dispatch:!1})}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(A.Actions),a.\u0275\u0275inject(c.Store))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),ft=(()=>{class o{constructor(r,i,E){this.action$=r,this.store=i,this.authConfigRepository=E,this.setToken$=(0,A.createEffect)(()=>this.action$.pipe((0,A.ofType)(q),(0,y.U)(({token:S})=>(null==S&&null==S?localStorage.removeItem(ie):localStorage.setItem(ie,S),ye({token:S})))))}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(A.Actions),a.\u0275\u0275inject(c.Store),a.\u0275\u0275inject(te))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})();var Ot=Object.freeze({__proto__:null}),jt=Object.freeze({__proto__:null}),Pt=Object.freeze({__proto__:null});class Dt{constructor(e){this.http=e}}let lt=(()=>{class o{constructor(r){this.authConfigRepository=r}canActivate(r,i){return localStorage.setItem(ot,i.url),this.check()}check(r,i){return(0,z.D)(new Promise((E,S)=>{this.authConfigRepository.isAuthenticated()?E(!0):(this.authConfigRepository.initAuthConfig(!0),E(!1))}))}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(te))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})(),ht=(()=>{class o{constructor(r){this.authConfigRepository=r}canActivate(r,i){return this.authConfigRepository.initAuthConfig(!1),!0}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(te))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})();var Ue=function(o){return o.KEYCLOAK="KEYCLOAK",o.OTHER="OTHER",o}(Ue||{});let Xt=(()=>{class o{constructor(r,i){this.authConfigRepository=r,this._tokenRepository=i}intercept(r,i){let E=this.authConfigRepository.getConfig();if(this.isNotExcluded(r,E)){if(this.userAuthenticatedWithKeycloak(E))return this._tokenRepository.addTokenToHeader(r.headers).pipe((0,O.z)(S=>{const I=r.clone({headers:S});return i.handle(I)}));this.token&&(r=r.clone({setHeaders:{Authorization:`Bearer ${this.token}`},withCredentials:!0}))}return i.handle(r)}get token(){return this._tokenRepository.getToken()}endpointToExclude(r,i){return null!=i&&i.map(E=>r.url.startsWith(E)).includes(!0)}isNotExcluded(r,i){return!r.url.startsWith("/assets")&&null!=i&&!this.endpointToExclude(r,i.excludeEndpoints)}userAuthenticatedWithKeycloak(r){return r&&r.authType&&r.authType===Ue.KEYCLOAK}static#e=this.\u0275fac=function(i){return new(i||o)(a.\u0275\u0275inject(te),a.\u0275\u0275inject(ae))};static#t=this.\u0275prov=a.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}return o})();const dt=(0,c.createSelector)(pe,ee,(o,e)=>!(!o.token||""===o.token)),pt=(0,c.createSelector)(Re,dt,(o,e)=>!!(o._authUser&&e&&o._authUser&&e));function vt(o,e){return()=>new Promise(function(){var i=(0,f.Z)(function*(E,S){try{o.dispatch(q({token:localStorage.getItem(ie)})),e.events.subscribe(b=>{b instanceof Ae.NavigationEnd&&!b.urlAfterRedirects.includes("#state")&&localStorage.setItem(ot,b.urlAfterRedirects)});const I=o.select(be).subscribe(b=>{b&&(e.navigate([e.url]),I?.unsubscribe())});E(!0)}catch(I){S(I)}});return function(E,S){return i.apply(this,arguments)}}())}function gt(o,e){return(i,E)=>(0,f.Z)(function*(){e.CreateStore("ActionStore",U.ActionReducer),e.CreateStore("GlobalStore",U.GlobalReducer),e.RegisterGlobalActions("ActionStore",[U.EMIT_ACTION,U.RESET_ACTION]),e.RegisterGlobalActions("GlobalStore",[U.EMIT_STATE]),e.Subscribe("ActionStore",b=>{let N=b.action;if(N){let L=(0,c.createAction)(N.actionType,(0,c.props)());i.dispatch(L({...N.payload})),e.DispatchAction("ActionStore",(0,U.ResetAction)())}}),i.select(rt).subscribe(b=>{e.DispatchAction("GlobalStore",(0,U.EmitState)({stateName:"_tokenState",payload:b}))}),i.select(Ze).subscribe(b=>{e.DispatchAction("GlobalStore",(0,U.EmitState)({stateName:"_authConfigState",payload:b}))}),i.select(Re).subscribe(b=>{e.DispatchAction("GlobalStore",(0,U.EmitState)({stateName:"_authState",payload:b}))});let I=ve[0];if(null!=I){const b=yield I.initLogin(!0);console.warn(b)}return()=>o})}let Bt=(()=>{class o{static forRoot(r){return{ngModule:o,providers:[{provide:a.APP_INITIALIZER,useFactory:gt(r,P.GlobalStore.Get(!1)),multi:!0,deps:[c.Store,a.Injector]},{provide:a.APP_INITIALIZER,useFactory:vt,multi:!0,deps:[c.Store,Ae.Router]}]}}static forChild(){return{ngModule:o,providers:[]}}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=a.\u0275\u0275defineNgModule({type:o});static#r=this.\u0275inj=a.\u0275\u0275defineInjector({providers:[lt,we,ht,st,te,ae,at],imports:[xt.CommonModule,Ae.RouterModule,R.HttpClientModule,c.StoreModule.forFeature("_tokenState",tt),c.StoreModule.forFeature("_authState",We),c.StoreModule.forFeature("_authConfigState",Ve),A.EffectsModule.forFeature([ft,ut,ct])]})}return o})()},44423:(s,m,g)=>{function f(a,A,d,y,F,O,U){try{var P=a[O](U),R=P.value}catch(z){return void d(z)}P.done?A(R):Promise.resolve(R).then(y,F)}function c(a){return function(){var A=this,d=arguments;return new Promise(function(y,F){var O=a.apply(A,d);function U(R){f(O,y,F,U,P,"next",R)}function P(R){f(O,y,F,U,P,"throw",R)}U(void 0)})}}g.d(m,{Z:()=>c})}}]);